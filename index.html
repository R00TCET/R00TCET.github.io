<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>—î–î–æ–∫—É–º–µ–Ω—Ç</title>

  <!-- –î–∏–Ω–∞–º—ñ—á–Ω–æ –≤–±—É–¥–æ–≤–∞–Ω–∏–π –º–∞–Ω—ñ—Ñ–µ—Å—Ç PWA -->
  <link id="manifest" rel="manifest">

  <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è iOS (—á–æ—Ä–Ω–∏–π —Å—Ç–∞—Ç—É—Å-–±–∞—Ä) -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAYAAABS3GwHAAAAAXNSR0IArs4c6QAAAyJJREFUeF7t0AEBAAAAEADC/2H5NEbDAwKChAAAAAAAAAAAAAD45wEAAAAAAAAAAAAA8McDAAAAAAAAAAAAAODjBwAAAAAAAAAAAABA/3kAAAAAAAAAAAAAwB8PAAAAAAAAAAAAAHg4AQAAAAAAAAAAAMD/eQAAAAAAAAAAAADAHw8AAAAAAAAAAAAA8HACAAAAAAAAAAAAgP7zAAAAAAAAAAAAAIC/HAAAAAAAAAAAAACAhxMAAAAAAAAAAAAA+s8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/xsA3g4Y9QAAAABJRU5ErkJggg==">
  <meta name="theme-color" content="#111111">

  <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è Lottie Animation -->
  <script src="https://cdn.lottielab.com/s/lottie-player@1.x/player-web.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap');

    :root {
      --text-color: #000;
      --label-color: #333;
      --background-gradient:
        radial-gradient(ellipse at 5% 5%, hsla(70, 88%, 88%, 0.8) 0, transparent 40%),
        radial-gradient(ellipse at 95% 90%, hsla(240, 88%, 85%, 0.7) 0, transparent 50%),
        linear-gradient(155deg, #e1f6b8, #bdecf3, #f5d5e5);
      --card-background: rgba(255, 255, 255, 0.45);
      --nav-background: #111;
      --nav-text-color: #8e8e93;
      --nav-active-color: #fff;
      --banner-background-soft: linear-gradient(90deg, rgba(173, 223, 173, 0.8), rgba(225, 246, 184, 0.85), rgba(173, 223, 173, 0.8));
    }

    @keyframes animatedBackground {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Manrope', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--background-gradient);
      background-size: 200% 200%;
      animation: animatedBackground 30s ease infinite;
      height: 100vh;
      color: var(--text-color);
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    /* --- –°–¢–ò–õ–Ü –î–õ–Ø –°–¢–ê–†–¢–û–í–û–ì–û –ï–ö–†–ê–ù–£ --- */
    #splash-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        background: linear-gradient(to bottom, #d4e7f5, #e9f3f9);
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        padding-bottom: 8vh;
        align-items: center;
        transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
    }
    #splash-screen.hidden {
        opacity: 0;
        visibility: hidden;
    }
    .splash-content {
        position: absolute;
        top: 25vh;
    }
    .splash-content h1 {
        font-size: 48px;
        color: #000;
        font-weight: 600;
    }
    .lottie-container {
        /* –í–ò–ü–†–ê–í–õ–ï–ù–û: –†–æ–∑–º—ñ—Ä –∑–º–µ–Ω—à–µ–Ω–æ –≤–¥–≤—ñ—á—ñ */
        
        margin: 0 auto;
    }
    
    /* --- –°–¢–ò–õ–Ü –î–õ–Ø –ï–ö–†–ê–ù–£ –í–í–û–î–£ –ü–ê–†–û–õ–Æ --- */
    #login-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: var(--background-gradient);
        background-size: 200% 200%;
        animation: animatedBackground 30s ease infinite;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        opacity: 0;
        visibility: hidden;
    }
    #login-screen.visible {
        opacity: 1;
        visibility: visible;
    }
    .login-title {
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 20px;
    }
    .passcode-dots {
        display: flex;
        gap: 15px; /* –í–ò–ü–†–ê–í–õ–ï–ù–û: –ó–º–µ–Ω—à–µ–Ω–æ –≤—ñ–¥—Å—Ç–∞–Ω—å */
        margin-bottom: 30px; /* –í–ò–ü–†–ê–í–õ–ï–ù–û: –ü—ñ–¥—Å—É–Ω—É—Ç–æ –±–ª–∏–∂—á–µ –¥–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ */
    }
    .passcode-dots.shake {
        animation: shake 0.3s linear;
    }
    .passcode-dot {
        /* –í–ò–ü–†–ê–í–õ–ï–ù–û: –†–æ–∑–º—ñ—Ä –∫—Ä–∞–ø–æ–∫ –∑–º–µ–Ω—à–µ–Ω–æ */
        width: 8px;
        height: 8px;
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        transition: background-color 0.2s ease;
    }
    .passcode-dot.filled {
        background-color: #000;
    }
    .keypad {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        width: 280px;
    }
    .keypad-btn {
        width: 75px;
        height: 75px;
        border-radius: 50%;
        border: none;
        background-color: rgba(255, 255, 255, 0.8);
        font-size: 28px;
        font-weight: 500;
        color: #000;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.2s ease;
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        -webkit-tap-highlight-color: transparent;
        outline: none;
    }
    .keypad-btn:active {
        background-color: rgba(255, 255, 255, 1);
    }
    .keypad-btn.icon {
        background: transparent;
        backdrop-filter: none;
    }
    .keypad-btn img {
        /* –í–ò–ü–†–ê–í–õ–ï–ù–û: –Ü–∫–æ–Ω–∫—É –≤—ñ–¥–±–∏—Ç–∫–∞ –∑–±—ñ–ª—å—à–µ–Ω–æ */
        width: 70px;
        height: 70px;
        opacity: 0.7;
    }
    .keypad-btn svg {
        width: 35px;
        height: 35px;
    }
    .forgot-password {
        /* –í–ò–ü–†–ê–í–õ–ï–ù–û: –ü–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–µ–Ω–æ */
        position: absolute;
        bottom: 5vh;
        padding: 10px;
        color: #000;
        font-size: 16px;
        cursor: pointer;
    }

    /* --- –•–æ–≤–∞—î–º–æ –æ—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ —Å—Ç–∞—Ä—Ç—ñ --- */
    .app-container {
      height: 100%;
      display: none;
      flex-direction: column;
    }
    .content { flex-grow: 1; position: relative; }

    .page {
      width: 100%; height: 100%; position: absolute; top: 0; left: 0;
      padding: 0;
      overflow: hidden;
      transition: opacity 0.4s ease-in-out;
      visibility: hidden; opacity: 0;
    }
    .page.active { visibility: visible; opacity: 1; }

    #page-docs.active { display: flex; flex-direction: column; justify-content: center; }

    .placeholder-page { display: flex; justify-content: center; align-items: center; height: 100%; font-size: 24px; color: #555; }

    .slider-container {
      width: 100%;
      height: 435px; /* –ó–±—ñ–ª—å—à–µ–Ω–æ –≤–∏—Å–æ—Ç—É –∫–∞—Ä—Ç–∫–∏ –Ω–∞ 15px */
      margin-top: -50px;
      display: flex;
      align-items: center;
      position: relative;
      overflow: hidden;
      cursor: grab;
    }
    .slider-wrapper {
      display: flex;
      align-items: center;
      gap: 3px; 
    }
    .slide {
      flex: 0 0 80%; 
      height: 100%; /* Use 100% of parent slider-container height */
      -webkit-tap-highlight-color: transparent;
    }

    .flip-card {
        background-color: transparent;
        width: 100%;
        height: 100%;
        perspective: 1000px;
        cursor: pointer;
    }
    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.6s;
        transform-style: preserve-3d;
    }
    .flip-card-inner.is-flipped { transform: rotateY(180deg); }
    .flip-card-front, .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
    .flip-card-back {
        transform: rotateY(180deg);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 15px;
        background: var(--card-background);
        border-radius: 24px;
        padding: 20px;
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .document-container {
        background: var(--card-background);
        border-radius: 24px;
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 1px solid rgba(255, 255, 255, 0.25);
        overflow: hidden;
        height: 100%;
        /* –í–æ—Ç–µ—Ä–º–∞—Ä–∫–∞ "FakeDiia" */
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200"><text x="10" y="50" font-family="Manrope" font-size="20" fill="rgba(0,0,0,0.08)" transform="rotate(-30 10 50)">FakeDiia</text><text x="150" y="120" font-family="Manrope" font-size="20" fill="rgba(0,0,0,0.08)" transform="rotate(-30 150 120)">FakeDiia</text><text x="50" y="160" font-family="Manrope" font-size="20" fill="rgba(0,0,0,0.08)" transform="rotate(-30 50 160)">FakeDiia</text></svg>');
        background-repeat: repeat;
        background-size: 150px 100px;
    }
    .empty-card { height: 100%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: #888; }
    .document-content { padding: 20px; }
    .document-title { 
        font-size: 24px; 
        font-weight: 600; /* –ó–º–µ–Ω—à–µ–Ω–æ –∂–∏—Ä–Ω—ñ—Å—Ç—å */
        margin-bottom: 20px; 
    }
    .personal-info {
        display: flex;
        align-items: flex-start;
        gap: 15px;
    }
    .photo {
        margin-top: 5px;
    }
    .photo img {
        width: 110px;
        height: 154px;
        border-radius: 12px;
        object-fit: cover;
        border: 1px solid rgba(255, 255, 255, 0.4);
    }
    .details { display: flex; flex-direction: column; gap: 15px; }
    .detail-item { display: flex; flex-direction: column; }
    .detail-item .label, .detail-item .value {
        font-size: 13px; /* –ó–º–µ–Ω—à–µ–Ω–æ —Ä–æ–∑–º—ñ—Ä –±—É–∫–≤ */
        font-weight: 500;
        color: var(--text-color);
    }
    .detail-item .label {
        color: var(--label-color);
    }

    .status-banner-wrapper {
      background: var(--banner-background-soft);
      overflow: hidden;
      white-space: nowrap;
      padding: 5px 0;
      margin-top: 30px; /* –ó–±—ñ–ª—å—à–µ–Ω–æ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ —Ñ–æ—Ç–æ —Ç–∞ –±—ñ–≥–∞—é—á–æ—é —Å—Ç—Ä–æ–∫–æ—é (15px + 15px default gap) */
    }
    @keyframes marquee {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
    }
    .status-banner span {
        padding-right: 8px;
        font-size: 13px;
        font-weight: 600;
        white-space: nowrap;
    }

    .info-section { padding: 20px; }
    .name-section {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        min-width: 0;
    }
    .full-name { display: flex; flex-direction: column; min-width: 0; }
    .name-part {
        font-size: 24px;
        font-weight: 600;
        line-height: 1.2;
        word-break: break-word;
    }
    .more-options {
        width: 18px; /* –ó–º–µ–Ω—à–µ–Ω–æ –≤ 2 —Ä–∞–∑–∏ */
        height: 18px; /* –ó–º–µ–Ω—à–µ–Ω–æ –≤ 2 —Ä–∞–∑–∏ */
        background-color: #2c2c2e;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-shrink: 0;
        margin-left: 10px;
        margin-bottom: 2px;
    }
    .more-options svg { 
        width: 12px; /* –ü—ñ–¥–ª–∞—à—Ç–æ–≤–∞–Ω–æ –ø—ñ–¥ –Ω–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä */
        height: 12px; /* –ü—ñ–¥–ª–∞—à—Ç–æ–≤–∞–Ω–æ –ø—ñ–¥ –Ω–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä */
        fill: #fff; 
    }

    .page-indicator-container {
        position: absolute;
        bottom: 95px;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        max-width: 400px;
        padding: 20px 0;
    }
    .page-indicator { display: flex; justify-content: center; gap: 8px; }
    .dot {
        width: 9px;
        height: 9px;
        background-color: rgba(255, 255, 255, 0.6);
        border-radius: 50%;
        transition: background-color 0.3s ease;
    }
    .dot.active { background-color: rgba(255, 255, 255, 1); }

    .bottom-nav { display: flex; justify-content: space-around; background-color: var(--nav-background); padding: 8px 0 20px 0; position: fixed; bottom: 0; left: 0; width: 100%; border-top-left-radius: 20px; border-top-right-radius: 20px; z-index: 100; }
    .nav-item { display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--nav-text-color); gap: 4px; padding: 0 10px; cursor: pointer; }
    .nav-icon { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; }
    .nav-label { font-size: 10px; }
    .nav-item.active .nav-label { color: var(--nav-active-color); }
    .nav-item.active[data-page="page-docs"] .nav-icon svg rect:first-of-type {
      fill: white;
    }
    .nav-item.active[data-page="page-docs"] .nav-icon svg path,
    .nav-item.active[data-page="page-docs"] .nav-icon svg rect:not(:first-of-type) {
      fill: black;
    }
    .nav-item.active[data-page="page-docs"] .nav-icon svg rect[stroke="black"] {
      stroke: black;
    }

    #update-notification { position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%); background-color: #28a745; color: white; padding: 10px 20px; border-radius: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 200; cursor: pointer; font-size: 14px; font-weight: 500; display: none; }

    #qr-timer { font-size: 18px; font-weight: 700; color: var(--text-color); }
    #qr-timer-passport { font-size: 18px; font-weight: 700; color: var(--text-color); } /* For the new passport card */
    .flip-card-back h3 { font-weight: 700; font-size: 16px; }
    .flip-card-back img { width: 200px; height: 200px; }

    /* --- –°–¢–ò–õ–Ü –î–õ–Ø –°–¢–û–†–Ü–ù–ö–ò –ú–ï–ù–Æ --- */
    #page-menu {
        background-color: #e3f2fd; /* Light blue background as in image */
        display: flex;
        flex-direction: column;
        padding-top: env(safe-area-inset-top, 20px); /* Adjust for notch/status bar */
        padding-bottom: 0; /* Nav bar will cover bottom initially */
        overflow-y: auto; /* Enable scrolling for menu if too long */
        -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
    }
    #page-menu.active {
      padding-bottom: 90px; /* Make space for the bottom nav when active */
    }

    .menu-header {
        padding: 20px;
        padding-bottom: 10px;
        text-align: left;
    }
    .menu-header h1 {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 5px;
    }
    .menu-header p {
        font-size: 14px;
        font-weight: 500;
        color: var(--label-color);
    }

    .menu-section {
        background-color: #fff;
        border-radius: 12px;
        margin: 10px 15px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        overflow: hidden; /* For rounded corners on inner items */
    }

    .menu-item {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        text-decoration: none;
        color: var(--text-color);
        font-size: 17px;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.1s ease;
        -webkit-tap-highlight-color: rgba(0,0,0,0.1); /* iOS tap effect */
    }
    .menu-item:not(:last-child) {
        border-bottom: 1px solid #f2f2f7; /* Separator line */
    }
    .menu-item:active {
        background-color: #f5f5f7;
    }
    .menu-item-icon {
        width: 24px;
        height: 24px;
        margin-right: 15px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-shrink: 0;
    }
    .menu-item-icon img, .menu-item-icon svg {
        width: 100%;
        height: 100%;
        color: #333; /* Default icon color */
    }
    .menu-item-text {
        flex-grow: 1;
    }
    .menu-item-arrow {
        width: 10px;
        height: 10px;
        border-right: 2px solid #ccc;
        border-bottom: 2px solid #ccc;
        transform: rotate(-45deg);
        margin-left: 10px;
    }

    /* --- –°–¢–ò–õ–Ü –î–õ–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –í–Ü–ö–ù–ê –ü–Ü–î–ü–ò–°–£ --- */
    .signature-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
    }
    .signature-modal-overlay.visible {
        opacity: 1;
        visibility: visible;
    }
    .signature-modal {
        background-color: #fff;
        border-radius: 15px;
        padding: 20px;
        margin: 20px;
        max-width: 400px;
        width: calc(100% - 40px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .signature-modal h2 {
        font-size: 22px;
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--text-color);
    }
    #signature-canvas {
        border: 1px solid #ccc;
        border-radius: 8px;
        background-color: #f9f9f9;
        touch-action: none; /* Prevent scrolling on canvas */
        margin-bottom: 20px;
        max-width: 100%; /* Ensure canvas scales on smaller screens */
    }
    .signature-buttons {
        display: flex;
        gap: 15px;
        width: 100%;
        justify-content: center;
    }
    .signature-buttons button {
        padding: 12px 25px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        border: none;
        transition: background-color 0.2s ease;
    }
    .signature-buttons button.clear-btn {
        background-color: #e0e0e0;
        color: #333;
    }
    .signature-buttons button.clear-btn:active {
        background-color: #d0d0d0;
    }
    .signature-buttons button.save-btn {
        background-color: #007aff; /* iOS blue */
        color: #fff;
    }
    .signature-buttons button.save-btn:active {
        background-color: #005ecb;
    }

    /* --- Passport Card Signature --- */
    .passport-signature {
        position: absolute;
        bottom: 110px; /* Adjust based on exact position in the image */
        right: 20px; /* Adjust based on exact position in the image */
        width: 120px; /* Size of the signature */
        height: 60px; /* Size of the signature */
        opacity: 0.8; /* Translucency */
        transform: rotate(-10deg); /* Diagonal orientation */
        z-index: 10;
        pointer-events: none; /* Don't block clicks on card */
    }
    .passport-signature img {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }
  </style>

</head>
<body>

  <!-- –°–¢–ê–†–¢–û–í–ò–ô –ï–ö–†–ê–ù -->
  <div id="splash-screen">
      <div class="splash-content">
          <h1>–ü—Ä–∏–≤—ñ—Ç üëã</h1>
      </div>
      <div class="lottie-container">
          <lottie-player id="lottie-player" src="splash_cropped.json" autoplay style="width:240px;"></lottie-player>
      </div>
  </div>

  <!-- –ï–ö–†–ê–ù –í–í–û–î–£ –ü–ê–†–û–õ–Æ -->
  <div id="login-screen">
    <h2 class="login-title">–ö–æ–¥ –¥–ª—è –≤—Ö–æ–¥—É</h2>
    <div class="passcode-dots">
      <div class="passcode-dot"></div>
      <div class="passcode-dot"></div>
      <div class="passcode-dot"></div>
      <div class="passcode-dot"></div>
    </div>
    <div class="keypad">
      <button class="keypad-btn">1</button>
      <button class="keypad-btn">2</button>
      <button class="keypad-btn">3</button>
      <button class="keypad-btn">4</button>
      <button class="keypad-btn">5</button>
      <button class="keypad-btn">6</button>
      <button class="keypad-btn">7</button>
      <button class="keypad-btn">8</button>
      <button class="keypad-btn">9</button>
      <button class="keypad-btn icon" id="fingerprint-btn">
          <img src="https://static.thenounproject.com/png/1238269-200.png" alt="–í—ñ–¥–±–∏—Ç–æ–∫">
      </button>
      <button class="keypad-btn">0</button>
      <button class="keypad-btn icon" id="backspace-btn">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.50006 5.5L4.05262 10.7909C3.71387 11.3107 3.69732 11.9772 4.00984 12.5133L7.50006 18.5H18.8588C19.7651 18.5 20.4999 17.7653 20.4999 16.8589V7.14109C20.4999 6.23474 19.7651 5.5 18.8588 5.5H7.50006Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M10 8.5L17 15.5" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M10 15.5L16.9303 8.49996" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="forgot-password">–ù–µ –ø–∞–º‚Äô—è—Ç–∞—é –∫–æ–¥ –¥–ª—è –≤—Ö–æ–¥—É</div>
  </div>

  <!-- –û–°–ù–û–í–ù–ò–ô –î–û–î–ê–¢–û–ö -->
  <div class="app-container">
    <main class="content">
      <div class="page" id="page-feed">
        <div class="placeholder-page"><h1>–°—Ç—Ä—ñ—á–∫–∞</h1></div>
      </div>

      <div class="page" id="page-docs">
        <div>
            <div class="slider-container">
              <div class="slider-wrapper">
                <!-- –°–õ–ê–ô–î 1: —î–î–æ–∫—É–º–µ–Ω—Ç -->
                <div class="slide">
                  <div class="flip-card">
                    <div class="flip-card-inner">
                      <div class="flip-card-front">
                        <div class="document-container">
                            <div class="document-content">
                              <h1 class="document-title">—î–î–æ–∫—É–º–µ–Ω—Ç</h1>
                              <div class="personal-info">
                                <div class="photo">
                                  <img src="./pasport.png" alt="–§–æ—Ç–æ">
                                </div>
                                <div class="details">
                                  <div class="detail-item">
                                    <span class="label">–î–∞—Ç–∞<br>–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:</span> <!-- –ó–º—ñ–Ω–µ–Ω–æ —Ç–µ–∫—Å—Ç –∑ –ø–µ—Ä–µ–Ω–æ—Å–æ–º -->
                                    <span class="value">29.07.2005</span>
                                  </div>
                                  <div class="detail-item">
                                    <span class="label">–†–ù–û–ö–ü–ü:</span>
                                    <span class="value">3856163250</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="status-banner-wrapper">
                              <div class="status-banner">
                                <span>–ê –º–∏ –Ω–∞—à—É —Å–ª–∞–≤–Ω—É –£–∫—Ä–∞—ó–Ω—É, –≥–µ–π, –≥–µ–π, —Ä–æ–∑–≤–µ—Å–µ–ª–∏–º–æ!</span>
                                <span>–ê –º–∏ –Ω–∞—à—É —Å–ª–∞–≤–Ω—É –£–∫—Ä–∞—ó–Ω—É, –≥–µ–π, –≥–µ–π, —Ä–æ–∑–≤–µ—Å–µ–ª–∏–º–æ!</span>
                              </div>
                            </div>
                            <div class="info-section">
                              <div class="name-section">
                                <div class="full-name">
                                  <span class="name-part">–Ü–≤–∞–Ω–æ–≤</span>
                                  <span class="name-part">–Ü–≤–∞–Ω</span>
                                  <span class="name-part">–Ü–≤–∞–Ω–æ–≤–∏—á</span>
                                </div>
                                <div class="more-options">
                                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
                                </div>
                              </div>
                            </div>
                        </div>
                      </div>
                      <div class="flip-card-back">
                          <h3>QR-–∫–æ–¥ –¥—ñ–π—Å–Ω–∏–π</h3>
                          <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=Example" alt="QR">
                          <div id="qr-timer"></div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- –°–õ–ê–ô–î 2: –ü–∞—Å–ø–æ—Ä—Ç –≥—Ä–æ–º–∞–¥—è–Ω–∏–Ω–∞ –£–∫—Ä–∞—ó–Ω–∏ (–Ω–æ–≤–∏–π –¥–æ–∫—É–º–µ–Ω—Ç) -->
                <div class="slide">
                    <div class="flip-card">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="document-container passport-document">
                                    <div class="document-content">
                                        <h1 class="document-title">–ü–∞—Å–ø–æ—Ä—Ç –≥—Ä–æ–º–∞–¥—è–Ω–∏–Ω–∞<br>–£–∫—Ä–∞—ó–Ω–∏</h1>
                                        <div class="personal-info">
                                            <div class="photo">
                                                <img src="./pasport.png" alt="–§–æ—Ç–æ">
                                            </div>
                                            <div class="details">
                                                <div class="detail-item">
                                                    <span class="label">–î–∞—Ç–∞<br>–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:</span>
                                                    <span class="value">29.07.2005</span>
                                                </div>
                                                <div class="detail-item">
                                                    <span class="label">–ù–æ–º–µ—Ä:</span>
                                                    <span class="value">013407632</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- –ú—ñ—Å—Ü–µ –¥–ª—è –ø—ñ–¥–ø–∏—Å—É -->
                                        <div class="passport-signature" id="passport-signature-display" style="display: none;">
                                            <img src="" alt="–í–∞—à –ø—ñ–¥–ø–∏—Å">
                                        </div>

                                        <div class="status-banner-wrapper">
                                            <div class="status-banner">
                                                <span>–î–æ–∫—É–º–µ–Ω—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ 12.09.2025 19:32 ‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ 12.09.2025 19:32 ‚Ä¢ </span>
                                                <span>–î–æ–∫—É–º–µ–Ω—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ 12.09.2025 19:32 ‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ 12.09.2025 19:32 ‚Ä¢ </span>
                                            </div>
                                        </div>
                                        <div class="info-section">
                                            <div class="name-section">
                                                <div class="full-name">
                                                    <span class="name-part">–Ü–≤–∞–Ω–æ–≤</span>
                                                    <span class="name-part">–Ü–≤–∞–Ω</span>
                                                    <span class="name-part">–Ü–≤–∞–Ω–æ–≤–∏—á</span>
                                                </div>
                                                <div class="more-options">
                                                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flip-card-back">
                                <h3>QR-–∫–æ–¥ –¥—ñ–π—Å–Ω–∏–π</h3>
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=PassportExample" alt="QR">
                                <div id="qr-timer-passport"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- –°–õ–ê–ô–î 3 -->
                <div class="slide"><div class="document-container empty-card">–ö–∞—Ä—Ç–∫–∞ –ø–ª–∞—Ç–Ω–∏–∫–∞ –ø–æ–¥–∞—Ç–∫—ñ–≤</div></div>
                <!-- –°–õ–ê–ô–î 4 -->
                <div class="slide"><div class="document-container empty-card">–î–æ–¥–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç</div></div>
              </div>
            </div>
        </div>
        <div class="page-indicator-container">
            <div class="page-indicator">
              <span class="dot active"></span>
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </div>
        </div>
      </div>

      <div class="page" id="page-services">
        <div class="placeholder-page"><h1>–°–µ—Ä–≤—ñ—Å–∏</h1></div>
      </div>

      <div class="page" id="page-menu">
        <div class="menu-header">
            <h1>–ú–µ–Ω—é</h1>
            <p>–í–µ—Ä—Å—ñ—è –î—ñ—ó: 4.13.1.1488</p>
        </div>

        <div class="menu-section">
            <div class="menu-item" id="menu-notifications">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                </div>
                <span class="menu-item-text">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</span>
                <div class="menu-item-arrow"></div>
            </div>
            <div class="menu-item" id="menu-diia-signature">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-key"><path d="M21 2L14 9l6.5 6.5c.6.6.6 1.5 0 2.1l-1.9 1.9c-.6.6-1.5.6-2.1 0L9 14 2 21"></path></svg>
                </div>
                <span class="menu-item-text">–î—ñ—è.–ü—ñ–¥–ø–∏—Å</span>
                <div class="menu-item-arrow"></div>
            </div>
            <div class="menu-item" id="menu-signature-history">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 10 9"></polyline></svg>
                </div>
                <span class="menu-item-text">–Ü—Å—Ç–æ—Ä—ñ—è –ø—ñ–¥–ø–∏—Å–∞–Ω—å</span>
                <div class="menu-item-arrow"></div>
            </div>
        </div>

        <div class="menu-section">
            <div class="menu-item" id="menu-settings">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </div>
                <span class="menu-item-text">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</span>
                <div class="menu-item-arrow"></div>
            </div>
            <div class="menu-item" id="menu-update-app">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.5 14h-3a9 9 0 0 1 16.7-6.2"></path><path d="M20.5 10h3a9 9 0 0 1-16.7 6.2"></path></svg>
                </div>
                <span class="menu-item-text">–û–Ω–æ–≤–∏—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫</span>
                <div class="menu-item-arrow"></div>
            </div>
            <div class="menu-item" id="menu-connected-devices">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-smartphone"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12" y2="18"></line></svg>
                </div>
                <span class="menu-item-text">–ü—ñ–¥–∫–ª—é—á–µ–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó</span>
                <div class="menu-item-arrow"></div>
            </div>
        </div>

        <div class="menu-section">
            <div class="menu-item" id="menu-support">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                </div>
                <span class="menu-item-text">–°–ª—É–∂–±–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏</span>
                <div class="menu-item-arrow"></div>
            </div>
            <div class="menu-item" id="menu-copy-device-number">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                </div>
                <span class="menu-item-text">–ö–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä –ø—Ä–∏—Å—Ç—Ä–æ—é</span>
                <div class="menu-item-arrow"></div>
            </div>
            <div class="menu-item" id="menu-faq">
                <div class="menu-item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                </div>
                <span class="menu-item-text">–ü–∏—Ç–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</span>
                <div class="menu-item-arrow"></div>
            </div>
        </div>

        <!-- Signature Modal -->
        <div class="signature-modal-overlay" id="signature-modal-overlay">
            <div class="signature-modal">
                <h2>–í–∞—à –ø—ñ–¥–ø–∏—Å</h2>
                <canvas id="signature-canvas" width="300" height="150"></canvas>
                <div class="signature-buttons">
                    <button class="clear-btn" id="clear-signature-btn">–°—Ç–µ—Ä—Ç–∏</button>
                    <button class="save-btn" id="save-signature-btn">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏</button>
                </div>
            </div>
        </div>
      </div>
    </main>

    <div id="update-notification">–î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è. –û–Ω–æ–≤–∏—Ç–∏?</div>

    <nav class="bottom-nav">
        <div class="nav-item" data-page="page-feed">
          <div class="nav-icon"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.99986 2.61536H12.9999C15.8283 2.61536 17.2425 2.61536 18.1212 3.49404C18.9999 4.37272 18.9999 5.78693 18.9999 8.61536V15.6154V20.6152C18.9999 21.7199 19.8954 22.6154 21 22.6154H6.99986C4.17143 22.6154 2.75722 22.6154 1.87854 21.7367C0.999861 20.858 0.999861 19.4438 0.999861 16.6154V8.61536C0.999861 5.78693 0.999861 4.37272 1.87854 3.49404C2.75722 2.61536 4.17143 2.61536 6.99986 2.61536Z" stroke="white" stroke-width="1.5"/><path d="M19 20.6154V13.6154H21C22.1046 13.6154 23 14.5108 23 15.6154V20.6154C23 21.7199 22.1046 22.6154 21 22.6154C19.8954 22.6154 19 21.7199 19 20.6154Z" stroke="white" stroke-width="1.5"/><rect x="4.5" y="17.1154" width="11" height="1.5" rx="0.5" fill="white"/><rect width="10" height="7" rx="1" transform="matrix(-1 0 0 1 15 6.61536)" stroke="white" stroke-width="1.5"/></svg></div>
          <span class="nav-label">–°—Ç—Ä—ñ—á–∫–∞</span>
        </div>
        <div class="nav-item active" data-page="page-docs">
          <div class="nav-icon"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2.75" y="2.36536" width="18.5" height="20.5" rx="3.25" stroke="white" stroke-width="1.5"/><path d="M6 18.6154C6 18.3392 6.22386 18.1154 6.5 18.1154H14.5C14.7761 18.1154 15 18.3392 15 18.6154V19.1154C15 19.3915 14.7761 19.6154 14.5 19.6154H6.5C6.22386 19.6154 6 19.3915 6 19.1154V18.6154Z"/><path d="M6 15.1154C6 14.8392 6.22386 14.6154 6.5 14.6154H17.5C17.7761 14.6154 18 14.8392 18 15.1154V15.6154C18 15.8915 17.7761 16.1154 17.5 16.1154H6.5C6.22386 16.1154 6 15.8915 6 15.6154V15.1154Z"/><mask id="path-4-inside-1_13657_22158" fill="white"><rect x="6" y="5.61536" width="7" height="7" rx="1"/></mask><rect x="6" y="5.61536" width="7" height="7" rx="1" stroke="white" stroke-width="3" mask="url(#path-4-inside-1_13657_22158)"/></svg></div>
          <span class="nav-label">–î–æ–∫—É–º–µ–Ω—Ç–∏</span>
        </div>
        <div class="nav-item" data-page="page-services">
          <div class="nav-icon"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-inside-1_13657_22172" fill="white"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 23.6154C5.84037 23.6154 4.18232 23.3034 2.74717 21.8682C1.30306 20.4241 1 18.775 1 12.6154C1 6.45573 1.31199 4.80661 2.74717 3.36253C4.18232 1.92735 5.84037 1.61536 12 1.61536C18.1596 1.61536 19.8177 1.92735 21.2528 3.36253C22.6969 4.80661 23 6.45573 23 12.6154C23 18.775 22.6969 20.4241 21.2528 21.8682C19.8177 23.3034 18.1596 23.6154 12 23.6154Z"/></mask><path d="M2.74717 21.8682L3.80785 20.8075L3.80782 20.8075L2.74717 21.8682ZM2.74717 3.36253L1.68649 2.30188L1.68324 2.30515L2.74717 3.36253ZM21.2528 3.36253L20.1922 4.42318L20.1922 4.42319L21.2528 3.36253ZM21.2528 21.8682L20.1922 20.8075L20.1922 20.8075L21.2528 21.8682ZM12 22.1154C8.90493 22.1154 7.08603 22.0336 5.88008 21.806C4.78166 21.5987 4.2908 21.2905 3.80785 20.8075L1.6865 22.9288C2.63869 23.881 3.69443 24.4465 5.32373 24.7539C6.84551 25.0411 8.93544 25.1154 12 25.1154V22.1154ZM3.80782 20.8075C3.31966 20.3194 3.01222 19.8284 2.80620 18.7329C2.57961 17.528 2.5 15.7117 2.5 12.6154H-0.5C-0.5 15.6786 -0.428084 17.7667 -0.142115 19.2873C0.164424 20.9173 0.730574 21.9729 1.68652 22.9289L3.80782 20.8075ZM2.5 12.6154C2.5 9.52026 2.58179 7.70371 2.80933 6.49901C3.01645 5.40245 3.32467 4.90936 3.81111 4.4199L1.68324 2.30515C0.734497 3.25978 0.169128 4.31329 -0.138544 5.94221C-0.425792 7.46301 -0.5 9.55083 -0.5 12.6154H2.5ZM3.80785 4.42318C4.2908 3.94021 4.78166 3.63203 5.88008 3.42473C7.08603 3.19714 8.90493 3.11536 12 3.11536V0.115356C8.93544 0.115356 6.84551 0.189572 5.32373 0.476771C3.69443 0.784262 2.63869 1.34967 1.68650 2.30188L3.80785 4.42318ZM12 3.11536C15.0951 3.11536 16.914 3.19714 18.1199 3.42473C19.2183 3.63203 19.7092 3.94021 20.1922 4.42318L22.3135 2.30188C21.3613 1.34967 20.3056 0.784261 18.6763 0.476771C17.1545 0.189572 15.0646 0.115356 12 0.115356V3.11536ZM20.1922 4.42319C20.6803 4.91135 20.9878 5.40236 21.1938 6.49785C21.4204 7.70272 21.5 9.51898 21.5 12.6154H24.5C24.5 9.55211 24.4281 7.46400 24.1421 5.94338C23.8356 4.31338 23.2694 3.25779 22.3135 2.30187L20.1922 4.42319ZM21.5 12.6154C21.5 15.7117 21.4204 17.528 21.1938 18.7329C20.9878 19.8284 20.6803 20.3194 20.1922 20.8075L22.3135 22.9288C23.2694 21.9729 23.8356 20.9173 24.1421 19.2873C24.4281 17.7667 24.5 15.6786 24.5 12.6154H21.5ZM20.1922 20.8075C19.7092 21.2905 19.2183 21.5987 18.1199 21.806C16.9140 22.0336 15.0951 22.1154 12 22.1154V25.1154C15.0646 25.1154 17.1545 25.0411 18.6763 24.7539C20.3056 24.4465 21.3613 23.8810 22.3135 22.9288L20.1922 20.8075Z" fill="white" mask="url(#path-1-inside-1_13657_22172)"/><path d="M14.1433 5.61549C14.1302 5.61651 14.1171 5.61817 14.1041 5.62046C14.0557 5.62707 14.0093 5.64237 13.9678 5.66544C13.9263 5.68851 13.8906 5.71885 13.8628 5.7546L7.39955 13.6136C7.36155 13.6611 7.33901 13.7169 7.33439 13.775C7.32976 13.8331 7.34323 13.8912 7.37333 13.9429C7.40342 13.9947 7.44899 14.0381 7.50506 14.0685C7.56113 14.099 7.62555 14.1151 7.69130 14.1154H11.1418L9.32393 19.1885C9.29398 19.2613 9.29508 19.3413 9.32702 19.4134C9.35895 19.4856 9.41953 19.5449 9.49737 19.5803C9.57521 19.6156 9.66495 19.6246 9.74976 19.6056C9.83456 19.5865 9.90858 19.5407 9.95792 19.4767L16.6007 11.6171C16.6387 11.5696 16.6613 11.5138 16.6659 11.4557C16.6705 11.3976 16.6571 11.3396 16.6270 11.2878C16.5969 11.2360 16.5513 11.1926 16.4952 11.1622C16.4392 11.1318 16.3748 11.1156 16.3090 11.1154H12.8417L14.4968 6.02785C14.5138 5.97950 14.5175 5.92825 14.5076 5.87837C14.4977 5.82850 14.4745 5.78143 14.4400 5.74109C14.4054 5.70076 14.3604 5.66831 14.3088 5.64647C14.2573 5.62462 14.2005 5.61400 14.1433 5.61549Z" fill="white"/></svg></div>
          <span class="nav-label">–°–µ—Ä–≤—ñ—Å–∏</span>
        </div>
        <div class="nav-item" data-page="page-menu">
          <div class="nav-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_5391_4802)"><circle cx="12" cy="12" r="11.25" stroke="white" stroke-width="1.5"/><path d="M2.25208 19C4.43043 15.9719 7.98493 14 12 14C16.015 14 19.5695 15.9719 21.7479 19C21.4436 19.423 21.1125 19.8253 20.7571 20.2045C18.877 17.3693 15.6568 15.5 12 15.5C8.34319 15.5 5.12301 17.3693 3.24289 20.2045C2.88744 19.8253 2.55633 19.4229 2.25208 19Z" fill="white"/><rect x="9" y="5" width="6" height="7" rx="3" stroke="white" stroke-width="1.5"/></g><defs><clipPath id="clip0_5391_4802"><rect width="24" height="24" rx="12" fill="white"/></clipPath></defs></svg></div>
          <span class="nav-label">–ú–µ–Ω—é</span>
        </div>
      </nav>
  </div>

  <script>
document.addEventListener('DOMContentLoaded', () => {

  // --- –õ–û–ì–Ü–ö–ê –°–¢–ê–†–¢–û–í–û–ì–û –ï–ö–†–ê–ù–£ –¢–ê –ï–ö–†–ê–ù–£ –í–•–û–î–£ ---
  const splashScreen = document.getElementById('splash-screen');
  const loginScreen = document.getElementById('login-screen');
  const appContainer = document.querySelector('.app-container');
  


  setTimeout(() => {
      splashScreen.classList.add('hidden');
      loginScreen.classList.add('visible');
      
      setTimeout(() => {
          if (splashScreen) {
            splashScreen.remove();
          }
      }, 500);

  }, 2500);

  // --- –õ–û–ì–Ü–ö–ê –í–í–û–î–£ –ü–ê–†–û–õ–Æ ---
  const passcodeDotsContainer = document.querySelector('.passcode-dots');
  const passcodeDots = document.querySelectorAll('.passcode-dot');
  const keypadBtns = document.querySelectorAll('.keypad-btn');
  const backspaceBtn = document.getElementById('backspace-btn');
  let passcode = '';
  const correctPasscode = '0000';

  const updateDots = () => {
    passcodeDots.forEach((dot, index) => {
      dot.classList.toggle('filled', index < passcode.length);
    });
  };

  const resetLogin = () => {
    passcode = '';
    updateDots();
    passcodeDotsContainer.classList.remove('shake');
  }

  const handleKeyPress = (key) => {
    if (passcode.length < 4) {
      passcode += key;
      updateDots();
    }

    if (passcode.length === 4) {
      setTimeout(() => {
        if (passcode === correctPasscode) {
          loginScreen.style.opacity = '0';
          setTimeout(() => {
            loginScreen.remove();
            appContainer.style.display = 'flex';
            navigateToPage('page-docs');
          }, 300);
        } else {
          passcodeDotsContainer.classList.add('shake');
          setTimeout(resetLogin, 500);
        }
      }, 200);
    }
  };

  keypadBtns.forEach(btn => {
    if (btn.textContent.trim() !== '' && !btn.querySelector('img') && !btn.querySelector('svg')) {
      btn.addEventListener('click', () => {
        handleKeyPress(btn.textContent);
      });
    }
  });
  
  backspaceBtn.addEventListener('click', () => {
    if (passcode.length > 0) {
        passcode = passcode.slice(0, -1);
        updateDots();
        passcodeDotsContainer.classList.remove('shake');
    }
  });

  // --- –ù–ê–í–Ü–ì–ê–¶–Ü–Ø ---
  const navItems = document.querySelectorAll('.nav-item');
  
  const navigateToPage = (targetPageId) => {
    const oldPage = document.querySelector('.page.active');
    const newPage = document.getElementById(targetPageId);
    
    if (oldPage) oldPage.classList.remove('active');
    if (newPage) newPage.classList.add('active');

    navItems.forEach(nav => {
        nav.classList.toggle('active', nav.dataset.page === targetPageId);
    });

    if (targetPageId === 'page-docs') {
        setTimeout(initializeCarousel, 0); 
    }
  }

  navItems.forEach(item => {
    item.addEventListener('click', () => {
      navigateToPage(item.dataset.page);
    });
  });
  
  document.querySelector('.page.active')?.classList.remove('active');
  document.querySelector('.nav-item.active')?.classList.remove('active');


  // --- –õ–û–ì–Ü–ö–ê –°–õ–ê–ô–î–ï–†–ê (–Ü–ù–¢–ï–†–ê–ö–¢–ò–í–ù–ê –ê–ù–Ü–ú–ê–¶–Ü–Ø) ---
  const sliderContainer = document.querySelector('.slider-container');
  const sliderWrapper = document.querySelector('.slider-wrapper');
  const slides = document.querySelectorAll('.slide');
  const dots = document.querySelectorAll('.page-indicator .dot');
  const slideCount = slides.length;

  let currentIndex = 0;
  let isDragging = false;
  let startPos = 0;
  let currentTranslate = 0;
  let prevTranslate = 0;
  let animationID;

  const getPositionX = (e) => e.type.includes('mouse') ? e.pageX : e.touches[0].clientX;
  
  const updateSliderDots = () => {
      dots.forEach((dot, index) => dot.classList.toggle('active', index === currentIndex));
  };

  const animation = () => {
    sliderWrapper.style.transform = `translateX(${currentTranslate}px)`;
    
    const containerCenter = sliderContainer.offsetWidth / 2;
    slides.forEach(slide => {
        const slideCenter = slide.offsetLeft + slide.offsetWidth / 2 + currentTranslate;
        const distance = Math.abs(containerCenter - slideCenter);
        const slideWidth = slide.offsetWidth;
        const distanceFactor = Math.min(distance / slideWidth, 1);
        
        const scale = 1 - (0.1 * distanceFactor);
        const opacity = 1 - (0.3 * distanceFactor);

        slide.style.transform = `scale(${scale})`;
        slide.style.opacity = `${opacity}`;
        slide.style.pointerEvents = scale > 0.99 ? 'auto' : 'none';
    });

    if (isDragging) requestAnimationFrame(animation);
  }
  
  const setFinalSliderPosition = () => {
    sliderWrapper.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
    slides.forEach(slide => {
        slide.style.transition = 'transform 0.4s ease, opacity 0.4s ease';
    });

    const targetSlide = slides[currentIndex];
    if (!targetSlide) return;
    const containerCenter = sliderContainer.offsetWidth / 2;
    const slideCenter = targetSlide.offsetLeft + targetSlide.offsetWidth / 2;
    
    currentTranslate = containerCenter - slideCenter;
    prevTranslate = currentTranslate;
    
    sliderWrapper.style.transform = `translateX(${currentTranslate}px)`;

    slides.forEach((slide, index) => {
        const scale = index === currentIndex ? 1 : 0.9;
        const opacity = index === currentIndex ? 1 : 0.7;
        slide.style.transform = `scale(${scale})`;
        slide.style.opacity = `${opacity}`;
        slide.style.pointerEvents = index === currentIndex ? 'auto' : 'none';
    });
    
    updateSliderDots();
  }

  const positionSliderByIndex = () => {
    setFinalSliderPosition();
  }

  const dragStart = (e) => {
    isDragging = true;
    startPos = getPositionX(e);
    sliderWrapper.style.transition = 'none';
    slides.forEach(slide => slide.style.transition = 'none');
    animationID = requestAnimationFrame(animation);
    sliderContainer.style.cursor = 'grabbing';
  };

  const dragMove = (e) => {
    if (!isDragging) return;
    const currentPosition = getPositionX(e);
    currentTranslate = prevTranslate + currentPosition - startPos;
  };

  const dragEnd = () => {
    if (!isDragging) return;
    isDragging = false;
    cancelAnimationFrame(animationID);
    sliderContainer.style.cursor = 'grab';

    const movedBy = currentTranslate - prevTranslate;
    
    if (movedBy < -80 && currentIndex < slideCount - 1) {
      currentIndex++;
    }
    if (movedBy > 80 && currentIndex > 0) {
      currentIndex--;
    }

    positionSliderByIndex();
  };
  
  const initializeCarousel = () => {
      if (!slides[currentIndex] || sliderContainer.offsetWidth === 0) return;
      
      sliderWrapper.style.transition = 'none';
      slides.forEach(slide => slide.style.transition = 'none');

      const targetSlide = slides[currentIndex];
      const containerCenter = sliderContainer.offsetWidth / 2;
      const slideCenter = targetSlide.offsetLeft + targetSlide.offsetWidth / 2;
      
      currentTranslate = containerCenter - slideCenter;
      prevTranslate = currentTranslate;
      
      animation();
      updateSliderDots();
  }
  
  window.addEventListener('resize', initializeCarousel);

  ['mousedown', 'touchstart'].forEach(e => sliderContainer.addEventListener(e, dragStart, { passive: true }));
  ['mouseup', 'touchend', 'mouseleave'].forEach(e => document.addEventListener(e, dragEnd));
  ['mousemove', 'touchmove'].forEach(e => document.addEventListener(e, dragMove, { passive: true }));

  // --- –õ–û–ì–Ü–ö–ê –ü–ï–†–ï–í–ï–†–¢–ê–ù–ù–Ø –ö–ê–†–¢–ö–ò –Ü –¢–ê–ô–ú–ï–†–ê ---
  const flipCards = document.querySelectorAll('.flip-card');
  const timerEl = document.getElementById('qr-timer'); // For —î–î–æ–∫—É–º–µ–Ω—Ç

  function startTimer(element) {
      clearInterval(element.timerInterval); // Use a property on the element to store its interval
      let timeLeft = 180;
      const updateTimerText = () => {
        const minutes = Math.floor(timeLeft / 60);
        let seconds = timeLeft % 60;
        seconds = seconds < 10 ? '0' + seconds : seconds;
        element.textContent = `${minutes}:${seconds}`;
      };
      updateTimerText();
      element.timerInterval = setInterval(() => {
          timeLeft--;
          updateTimerText();
          if (timeLeft <= 0) {
              clearInterval(element.timerInterval);
              element.textContent = "–ß–∞—Å –≤–∏–π—à–æ–≤";
          }
      }, 1000);
  }

  flipCards.forEach(card => {
    card.addEventListener('click', (e) => {
        const movedBy = Math.abs(currentTranslate - prevTranslate);
        if (isDragging && movedBy > 10) return;
        
        const slide = card.closest('.slide');
        if (slide.style.transform !== 'scale(1)') return; // Only flip if it's the centered card

        const inner = card.querySelector('.flip-card-inner');
        const timerElement = card.closest('.slide').querySelector('[id^="qr-timer"]'); // Find the correct timer for this card
        
        inner.classList.toggle('is-flipped');
        if (inner.classList.contains('is-flipped')) {
            startTimer(timerElement);
        } else {
            clearInterval(timerElement.timerInterval);
            setTimeout(() => {
                if (!inner.classList.contains('is-flipped')) {
                    timerElement.textContent = "";
                }
            }, 600);
        }
    });
  });

  // --- –õ–û–ì–Ü–ö–ê –î–Ü–Ø.–ü–Ü–î–ü–ò–°–£ –¢–ê –ü–ê–°–ü–û–†–¢–ê ---
  const diiaSignatureMenuItem = document.getElementById('menu-diia-signature');
  const signatureModalOverlay = document.getElementById('signature-modal-overlay');
  const signatureCanvas = document.getElementById('signature-canvas');
  const clearSignatureBtn = document.getElementById('clear-signature-btn');
  const saveSignatureBtn = document.getElementById('save-signature-btn');
  const passportSignatureDisplay = document.getElementById('passport-signature-display');
  const passportSignatureImage = passportSignatureDisplay.querySelector('img');

  const ctx = signatureCanvas.getContext('2d');
  let isSigning = false;
  let lastX = 0;
  let lastY = 0;
  let signatureDataURL = localStorage.getItem('diiaSignature') || null; // Load saved signature

  // Function to initialize canvas for drawing
  function initCanvas() {
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';
    ctx.strokeStyle = '#000';
    clearCanvas(); // Clear canvas when modal opens
    if (signatureDataURL) { // If there's a saved signature, load it temporarily for editing
      const img = new Image();
      img.onload = () => {
        ctx.drawImage(img, 0, 0, signatureCanvas.width, signatureCanvas.height);
      };
      img.src = signatureDataURL;
    }
  }

  // Function to clear the canvas
  function clearCanvas() {
    ctx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
  }

  // Event listeners for drawing on canvas
  function drawStart(e) {
    isSigning = true;
    [lastX, lastY] = getCanvasCoordinates(e);
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
  }

  function drawMove(e) {
    if (!isSigning) return;
    e.preventDefault(); // Prevent scrolling on touch devices
    let [currentX, currentY] = getCanvasCoordinates(e);
    ctx.lineTo(currentX, currentY);
    ctx.stroke();
    [lastX, lastY] = [currentX, currentY];
  }

  function drawEnd() {
    isSigning = false;
    ctx.closePath();
  }

  function getCanvasCoordinates(event) {
    const rect = signatureCanvas.getBoundingClientRect();
    let clientX, clientY;
    if (event.touches) {
      clientX = event.touches[0].clientX;
      clientY = event.touches[0].clientY;
    } else {
      clientX = event.clientX;
      clientY = event.clientY;
    }
    return [
      clientX - rect.left,
      clientY - rect.top
    ];
  }

  // Add event listeners to canvas
  signatureCanvas.addEventListener('mousedown', drawStart);
  signatureCanvas.addEventListener('mousemove', drawMove);
  signatureCanvas.addEventListener('mouseup', drawEnd);
  signatureCanvas.addEventListener('mouseout', drawEnd); // Stop drawing if mouse leaves canvas

  signatureCanvas.addEventListener('touchstart', drawStart, { passive: false }); // Prevent scrolling
  signatureCanvas.addEventListener('touchmove', drawMove, { passive: false });
  signatureCanvas.addEventListener('touchend', drawEnd);
  signatureCanvas.addEventListener('touchcancel', drawEnd);

  // Show signature modal when "–î—ñ—è.–ü—ñ–¥–ø–∏—Å" is clicked
  diiaSignatureMenuItem.addEventListener('click', () => {
    signatureModalOverlay.classList.add('visible');
    // Ensure canvas size is correct for retina displays, then clear and load
    const dpi = window.devicePixelRatio || 1;
    signatureCanvas.width = signatureCanvas.offsetWidth * dpi;
    signatureCanvas.height = signatureCanvas.offsetHeight * dpi;
    ctx.scale(dpi, dpi);
    initCanvas();
  });

  // Hide modal when clicking outside (on overlay)
  signatureModalOverlay.addEventListener('click', (e) => {
    if (e.target === signatureModalOverlay) {
      signatureModalOverlay.classList.remove('visible');
    }
  });

  // Clear button functionality
  clearSignatureBtn.addEventListener('click', () => {
    clearCanvas();
    signatureDataURL = null; // Clear saved signature as well
    localStorage.removeItem('diiaSignature');
    updatePassportSignature();
  });

  // Save button functionality
  saveSignatureBtn.addEventListener('click', () => {
    // Only save if something was drawn (canvas is not empty)
    const dataURL = signatureCanvas.toDataURL();
    const blank = document.createElement('canvas');
    blank.width = signatureCanvas.width;
    blank.height = signatureCanvas.height;
    ctx.clearRect(0, 0, blank.width, blank.height); // Ensure blank canvas is truly blank
    if (dataURL !== blank.toDataURL()) { // Check if canvas is not blank
      signatureDataURL = dataURL;
      localStorage.setItem('diiaSignature', signatureDataURL); // Save to local storage
      updatePassportSignature();
    }
    signatureModalOverlay.classList.remove('visible');
  });

  // Function to update the signature in the Passport card
  function updatePassportSignature() {
    if (signatureDataURL) {
      passportSignatureImage.src = signatureDataURL;
      passportSignatureDisplay.style.display = 'block';
    } else {
      passportSignatureDisplay.style.display = 'none';
      passportSignatureImage.src = '';
    }
  }

  // Call this function when the app loads to display any previously saved signature
  updatePassportSignature();

  // --- –õ–û–ì–Ü–ö–ê SERVICE WORKER ---
  const VERSION = new Date().getTime();
  const CACHE_NAME = `diia-clone-cache-v${VERSION}`;
  const manifest = {
    "name": "—î–î–æ–∫—É–º–µ–Ω—Ç", "short_name": "—î–î–æ–∫—É–º–µ–Ω—Ç", "start_url": ".", "display": "standalone", "background_color": "#c9e3eb", "theme_color": "#111111",
    "icons": [{"src": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAYAAABS3GwHAAAAAXNSR0IArs4c6QAAAyJJREFUeF7t0AEBAAAAEADC/2H5NEbDAwKChAAAAAAAAAAAAAD45wEAAAAAAAAAAAAA8McDAAAAAAAAAAAAAODjBwAAAAAAAAAAAABA/3kAAAAAAAAAAAAAwB8PAAAAAAAAAAAAAHg4AQAAAAAAAAAAAMD/eQAAAAAAAAAAAADAHw8AAAAAAAAAAAAA8HACAAAAAAAAAAAAgP7zAAAAAAAAAAAAAIC/HAAAAAAAAAAAAACAhxMAAAAAAAAAAAAA+s8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/x4AAAAAAAAAAAAA8OECAAAAAAAAAAAA+M8DAAAAAAAAAAAAAOBfDwAAAAAAAAAAAACAxxMAAAAAAAAAAAAA4f88AAAAAAAAAAAAAOAfDwAAAAAAAAAAAADw4AQAAAAAAAAAAAD8nwcAAAAAAAAAAAAA8K8HAAAAAAAAAAAAAPBhAgAAAAAAAAAAAPh/ngAAAAAAAAAAAADA/xsA3g4Y9QAAAABJRU5ErkJggg==", "sizes": "192x192", "type": "image/png"}]
  };
  const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
  document.getElementById('manifest').href = URL.createObjectURL(manifestBlob);
  const swCode = `
    const CACHE_NAME = '${CACHE_NAME}';
    const urlsToCache = ['${location.href.replace(/\?.*$/, '')}'];
    self.addEventListener('install', e => e.waitUntil(caches.open(CACHE_NAME).then(c => c.addAll(urlsToCache))));
    self.addEventListener('activate', e => e.waitUntil(caches.keys().then(names => Promise.all(names.map(name => name !== CACHE_NAME && caches.delete(name))))));
    self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))));
    self.addEventListener('message', e => { if (e.data.action === 'skipWaiting') self.skipWaiting(); });
  `;
  const swBlob = new Blob([swCode], { type: 'application/javascript' });

  if ('serviceWorker' in navigator) {
    let newWorker;
    const updateNotification = document.getElementById('update-notification');
    updateNotification.addEventListener('click', () => newWorker.postMessage({ action: 'skipWaiting' }));
    navigator.serviceWorker.register(URL.createObjectURL(swBlob)).then(reg => {
      reg.addEventListener('updatefound', () => {
        newWorker = reg.installing;
        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
            updateNotification.style.display = 'block';
          }
        });
      });
    });
    let refreshing;
    navigator.serviceWorker.addEventListener('controllerchange', () => {
      if (refreshing) return;
      window.location.reload();
      refreshing = true;
    });
  }
});
  </script>
</body>
</html>
